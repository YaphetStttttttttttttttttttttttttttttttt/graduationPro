<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
    
    <mapper namespace="com.gp.mapper.CourseMapper">
        <resultMap type="Course" id="courseBean">
            <id column="cid" property="id" />
            <result column="cname" property="name" />
            <result column="type" property="type" />
            <result column="credit" property="credit" />
            <result column="cycle" property="cycle" />
            <result column="start_time" property="start_time" />
            <result column="start_term" property="start_term" />
            <result column="place" property="place" />
            
            <collection property="tid" ofType="Teacher">
                <id column="teid" property="id" />
                <result column="tname" property="name" />          
            </collection>
            <collection property="selectCourse" ofType="Select_course">
            	<result column="f_grade" property="f_grade" />
            	<result column="s_grade" property="s_grade" />
            	<result column="t_grade" property="t_grade" />
                <association property="sid" javaType="Student">
                    <id column="sid" property="id"/>
                    <result column="sname" property="name"/>
                </association>            
            </collection>
        </resultMap>
         
        <select id="listCourse" resultMap="courseBean">
            select c.*,t.*,sc.*,s.*, c.id 'cid', t.id 'teid', s.id 'sid', c.name 'cname', t.name 'tname', s.name 'sname'
                from course c
                left join select_course sc on c.id =sc.cid
                left join student s on s.id = sc.sid
                left join teacher t on t.id = c.tid
                where s.id = #{sid}
        </select>
        
        <select id="listSelectCourse" resultType="Course">
        	select * from course where id not in (select cid from select_course where sid = #{sid})
        </select>     
    </mapper>